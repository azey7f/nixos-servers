{
	"$schema": "https://docs.renovatebot.com/renovate-schema.json",
	"extends": [
		"config:recommended"
	],
	"customDatasources": {
		"grafana-dashboards": {
			"defaultRegistryUrlTemplate": "https://grafana.com/api/dashboards/{{packageName}}",
			"format": "json",
			"transformTemplates": [
				"{\"releases\":[{\"version\": $string(revision)}]}"
			]
		}
	},
	"customManagers": [
		{
			"customType": "regex",
			"managerFilePatterns": [
				"/\\.nix$/"
			],
			"matchStrings": [
				"image\\s*=\\s*\"(?<depName>\\S+):(?<currentValue>\\S+)\"\\s*;",
				"chart\\s*=\\s*\"\\S+:\\/\\/(?<depName>\\S+)\"\\s*;\\s*version\\s*=\\s*\"(?<currentValue>\\S+)\"\\s*;"
			],
			"datasourceTemplate": "docker"
		},
		{
			"customType": "regex",
			"managerFilePatterns": ["/\\.nix$/"],
			"matchStrings": [
				"repo\\s*=\\s*\"(?<registryUrl>\\S+)\"\\s*;\\s*chart\\s*=\\s*\"(?<depName>\\S+)\"\\s*;\\s*version\\s*=\\s*\"(?<currentValue>\\S+)\"\\s*;"
			],
			"datasourceTemplate": "helm"
		},
		{
			"customType": "regex",
			"managerFilePatterns": ["/\\.nix$/"],
			"matchStrings": [
				"(?<depName>\\S+)\\s*=\\s*{\\s*gnetId\\s*=\\s*(?<packageName>[0-9]+)\\s*;\\s*revision\\s*=\\s*(?<currentValue>[0-9]+)\\s*;"
			],
			"depNameTemplate": "grafana-dashboard-{{depName}}",
			"versioningTemplate": "regex:^(?<major>\\d+)$",
			"datasourceTemplate": "custom.grafana-dashboards"
		}
	],
	"packageRules": [
		{
			"matchUpdateTypes": [
				"patch"
			],
			"groupName": "automerge-patch",
			"automerge": true,
			"automergeType": "branch"
		},
		{
			"matchUpdateTypes": [
				"minor"
			],
			"matchDepNames": [
				"cloudnative-pg",
				"code.forgejo.org/forgejo-helm/forgejo",
				"ghcr.io/woodpecker-ci/helm/woodpecker",
				"ghcr.io/prometheus-community/charts/kube-prometheus-stack",
				"mail",
				"cert-manager",
				"snowdreamtech/frpc",
				"registry.k8s.io/git-sync/git-sync",
				"nginxinc/nginx-unprivileged",
				"px01/blocky",
				"klutchell/unbound"
			],
			"groupName": "automerge-minor",
			"automerge": true,
			"automergeType": "branch"
		},
		{
			"matchDepNames": [
				"renovate",
				"ghcr.io/jeffvli/feishin",
				"docker.io/searxng/searxng",
				"^grafana-dashboard-"
			],
			"groupName": "automerge-reckless",
			"automerge": true,
			"automergeType": "branch"
		},
		{
			"matchDepNames": [
				"authelia"
			],
			"groupName": "dont-automerge",
			"automerge": false
		}
	]
}
